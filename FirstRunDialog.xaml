<Window x:Class="Explore.FirstRunDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:FileReName.Converters"
        Title="初回セットアップ（Hot Start）"
        Height="320" Width="620"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        ShowInTaskbar="False"
        WindowStyle="SingleBorderWindow">
    <Window.Resources>
        <conv:BoolToVisibilityConverter x:Key="BoolToVisibility"/>
    </Window.Resources>

    <Grid Margin="14">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock FontSize="16" FontWeight="SemiBold"
               Text="DB を更新して、すぐ使える状態にします（Hot Start）"
               Margin="0,0,0,12"/>
        <TextBlock Grid.Row="1" TextWrapping="Wrap"
               Text="既知フォルダーや最近のファイルを優先的に取り込みます。システム/隠しなど一部は除外します。"
               Margin="0,0,0,16"/>

        <ProgressBar Grid.Row="2" Height="14" Minimum="0" Maximum="100"
                 Value="{Binding Percent, Mode=OneWay}" />

        <!-- ステータス + 完了表示 -->
        <StackPanel Grid.Row="3" Orientation="Vertical" Margin="0,10,0,10">
            <TextBlock Text="{Binding Phase}" FontWeight="SemiBold"/>
            <TextBlock Margin="0,4,0,0" Text="{Binding StatusLine}"/>
            <TextBlock Margin="0,4,0,0" Text="{Binding DetailLine}" />
            <!-- 完了メッセージ（成功時のみ表示） -->
            <TextBlock Margin="0,8,0,0"
                 Text="{Binding CompletionMessage}"
                 FontWeight="Bold"
                 Foreground="{DynamicResource ThemeBrush}"
                 Visibility="{Binding ShowCompletion, Converter={StaticResource BoolToVisibility}}"/>
        </StackPanel>

        <!-- ボタン列 -->
        <DockPanel Grid.Row="4">
            <CheckBox Content="完了後もバックグラウンドで続ける"
                VerticalAlignment="Center"
                IsChecked="{Binding Settings.FirstRun.ColdIndexInBackground}"
                DockPanel.Dock="Left"/>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" DockPanel.Dock="Right">
                <Button x:Name="StartBtn" Content="DBを更新（Hot Start）" Width="180" Height="30" Margin="0,0,6,0" Click="OnStartClick"/>
                <Button x:Name="CancelBtn" Content="閉じる" Width="150" Height="30" Click="OnCancelClick"/>
            </StackPanel>
        </DockPanel>
    </Grid>
</Window>
